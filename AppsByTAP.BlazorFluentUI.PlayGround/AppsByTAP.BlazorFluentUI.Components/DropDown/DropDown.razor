@using AppsByTAP.BlazorFluentUI.Components.Icon

@namespace AppsByTAP.BlazorFluentUI.Components.DropDown
@typeparam TItem
@inherits DropDownViewModel<TItem>

<div class="dropDownWrapper" @onblur="Close">
    <div class="dropDownCtrl @(Disabled ? "disabled" : "")" @onclick="OpenDropDown">
        <span class="dropDownSelection">@(SelectedItem is null ? "Select an option" : SelectedItem)</span>
        <span class="dropDownChenron"><Icon IconType="IconTypes.ChevronDown" /></span>
    </div>
    <div class="lightDismiss" style="display: @(_displayDropDown ? "block" : "none")" @onclick="Close" @onmousewheel="Close"></div>
    <div class="itemsPanel" style="display: @(_displayDropDown ? "block" : "none")">
        @foreach(TItem item in ItemsSource)
        {
            if(item is DropDownItem ddi)
            {
                if(ddi.Type == DropDownItemType.Item)
                {
                    <div class="item" @onclick="() => SelectItem(item)">@ddi.Item</div>
                }
                else
                {
                    <div class="header">@ddi.Item</div>
                }
            }
            else
            {
                <div class="item">@item</div>
            }
        }
    </div>
</div>